# Rollback to Stage

Stage ë¡¤ë°± ìŠ¤í‚¬

## ì„¤ëª…

ì›Œí¬í”Œë¡œìš° ìƒíƒœë¥¼ íŠ¹ì • Stageë¡œ ë¡¤ë°±í•©ë‹ˆë‹¤. í•´ë‹¹ Stage ì´í›„ì˜ Phaseë“¤ì„ ì´ˆê¸°í™”í•˜ê³ , í•´ë‹¹ Stageë¶€í„° ë‹¤ì‹œ ì‹œì‘í•  ìˆ˜ ìˆë„ë¡ ì¤€ë¹„í•©ë‹ˆë‹¤.

## íŠ¸ë¦¬ê±°

- `restore-point.md` ì™„ë£Œ í›„ í˜¸ì¶œ

## ì…ë ¥

- ëŒ€ìƒ Stage ID
- ì´í„°ë ˆì´ì…˜ ì´ìœ 
- ë³µì› ì§€ì  ê²½ë¡œ

## ì‹¤í–‰ ë‚´ìš©

### 1. ìƒíƒœ ì—…ë°ì´íŠ¸

`.workflow/state.json` ìˆ˜ì •:

```json
{
  "currentPhaseId": "{target_stage}",
  "phases": [
    // target_stage ì´ì „: ìœ ì§€
    { "id": "ideation", "status": "completed", ... },

    // target_stage: in_progressë¡œ ë³€ê²½
    { "id": "planning", "status": "in_progress", "startedAt": "now", ... },

    // target_stage ì´í›„: pendingìœ¼ë¡œ ì´ˆê¸°í™”
    { "id": "design", "status": "pending", "startedAt": null, ... },
    { "id": "development", "status": "pending", ... },
    { "id": "deployment", "status": "pending", ... }
  ]
}
```

### 2. ì´í„°ë ˆì´ì…˜ ê¸°ë¡ ì¶”ê°€

```json
{
  "iterations": [
    ...,
    {
      "id": "iter-{n}",
      "fromPhase": "{current_phase}",
      "toPhase": "{target_stage}",
      "reason": "{ì´í„°ë ˆì´ì…˜ ì´ìœ }",
      "timestamp": "2024-01-15T10:30:00Z",
      "restorePoint": "outputs/restore-points/{path}",
      "changes": []
    }
  ]
}
```

### 3. ì‚°ì¶œë¬¼ ì²˜ë¦¬

ì˜µì…˜ 1: **ìœ ì§€** (ê¸°ë³¸)
- ê¸°ì¡´ ì‚°ì¶œë¬¼ íŒŒì¼ë“¤ì„ ê·¸ëŒ€ë¡œ ìœ ì§€
- Stage ì¬ì§„í–‰ ì‹œ ë®ì–´ì“°ê¸°

ì˜µì…˜ 2: **ë°±ì—… í›„ ì´ˆê¸°í™”**
- ê¸°ì¡´ ì‚°ì¶œë¬¼ì„ `outputs/stage-{n}/_old/`ë¡œ ì´ë™
- ë¹ˆ ìƒíƒœì—ì„œ ì‹œì‘

```
"ê¸°ì¡´ ì‚°ì¶œë¬¼ì„ ì–´ë–»ê²Œ í• ê¹Œìš”?

1. ìœ ì§€ (ìƒˆ ë‚´ìš©ìœ¼ë¡œ ë®ì–´ì“°ê¸°)
2. ë°±ì—… í›„ ë¹„ìš°ê¸° (ê¹¨ë—í•˜ê²Œ ì‹œì‘)"
```

### 4. ì»¨í…ìŠ¤íŠ¸ ì¤€ë¹„

ë¡¤ë°±í•œ Stageì—ì„œ ì°¸ì¡°í•  ì •ë³´ ì¤€ë¹„:

```markdown
## ì´í„°ë ˆì´ì…˜ ì»¨í…ìŠ¤íŠ¸

### ì´ì „ ì‹œë„ì—ì„œ ë°œê²¬ëœ ë¬¸ì œ
{ì´í„°ë ˆì´ì…˜ ì´ìœ }

### ê´€ë ¨ í”¼ë“œë°±
{í•´ë‹¹ Stage ê´€ë ¨ í”¼ë“œë°± ìš”ì•½}

### ì´ì „ ì‚°ì¶œë¬¼ ì°¸ì¡°
{ì´ì „ ì‚°ì¶œë¬¼ ê²½ë¡œ ë˜ëŠ” ë‚´ìš© ìš”ì•½}
```

### 5. ì™„ë£Œ ë©”ì‹œì§€

```
"âœ… {target_stage} Stageë¡œ ë¡¤ë°± ì™„ë£Œ!

ğŸ“ í˜„ì¬ ìœ„ì¹˜: {target_stage}
ğŸ“ ë³µì› ì§€ì : {restore_point_path}
ğŸ“ ì´ìœ : {reason}

ì´ì œ /{command}ë¡œ ë‹¤ì‹œ ì‹œì‘í•  ìˆ˜ ìˆì–´ìš”.

ğŸ’¡ ì°¸ê³ : ì´ì „ì— ì´ëŸ° í”¼ë“œë°±ì´ ìˆì—ˆì–´ìš”:
{ê´€ë ¨ í”¼ë“œë°±}
"
```

## ì‚°ì¶œë¬¼

1. `.workflow/state.json` ì—…ë°ì´íŠ¸
2. (ì„ íƒì ) ì‚°ì¶œë¬¼ ë°±ì—…

## ì™„ë£Œ ì¡°ê±´

- ìƒíƒœ íŒŒì¼ ì—…ë°ì´íŠ¸ ì™„ë£Œ
- ì´í„°ë ˆì´ì…˜ ê¸°ë¡ ì¶”ê°€ ì™„ë£Œ
- ì‚°ì¶œë¬¼ ì²˜ë¦¬ ì™„ë£Œ (ìœ ì§€ ë˜ëŠ” ë°±ì—…)
- ì»¨í…ìŠ¤íŠ¸ ì¤€ë¹„ ì™„ë£Œ

## ë‹¤ìŒ ë‹¨ê³„

ë¡¤ë°± ì™„ë£Œ í›„:
1. í•´ë‹¹ Stage ì»¤ë§¨ë“œ ì•ˆë‚´ (`/plan`, `/design`, etc.)
2. ë˜ëŠ” ìë™ìœ¼ë¡œ í•´ë‹¹ Stage ì‹œì‘

## Phaseë³„ ë¡¤ë°± ì˜í–¥

| ë¡¤ë°± ëŒ€ìƒ | ì´ˆê¸°í™”ë˜ëŠ” Phase | ì˜ˆìƒ ì¬ì‘ì—…ëŸ‰ |
|----------|----------------|-------------|
| ideation | ëª¨ë“  Phase | ì „ì²´ ì¬ì‹œì‘ |
| planning | design, development, deployment | ì¤‘ê°„ |
| design | development, deployment | ì¤‘ê°„ |
| development | deployment | ì ìŒ |
| deployment | ì—†ìŒ | ìµœì†Œ |

## ì£¼ì˜ì‚¬í•­

1. **ì½”ë“œ ë³´ì¡´**: Developmentë¡œ ë¡¤ë°±í•´ë„ ì‘ì„±ëœ ì½”ë“œ íŒŒì¼ì€ ì‚­ì œë˜ì§€ ì•ŠìŒ
2. **ì‚°ì¶œë¬¼ë§Œ ì˜í–¥**: Stage ì‚°ì¶œë¬¼(.md íŒŒì¼)ë§Œ ê´€ë¦¬ë¨
3. **ì—°ì‡„ ì˜í–¥ ê²½ê³ **: Planningìœ¼ë¡œ ë¡¤ë°± ì‹œ ì´í›„ ëª¨ë“  Stage ì¬ì§„í–‰ í•„ìš”í•¨ì„ ì•ˆë‚´
