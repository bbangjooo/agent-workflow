# Suggest Next Action

다음 액션 제안 스킬

## 설명

수집된 학습점과 개선점을 바탕으로 다음에 취할 액션을 제안합니다. 계속 진행할지, 이전 Stage로 돌아갈지, 새 버전을 시작할지 결정을 돕습니다.

## 트리거

- `validate-goal-alignment.md` 완료 후 호출
- (기존: `identify-improvements.md` 완료 후 → 이제 `validate-goal-alignment`를 거침)

## 입력

- `gather-learnings`의 학습점
- `identify-improvements`의 개선점
- `validate-goal-alignment`의 검증 결과 (NEW)
- 현재 워크플로우 상태

## 실행 내용

### 1. 피드백 요약

수집된 내용을 간결하게 정리:

```
"정리해볼게요:

✅ 잘된 점:
- {핵심 1}
- {핵심 2}

🔧 개선 필요:
- {핵심 1}
- {핵심 2}

💡 핵심 인사이트:
{가장 중요한 깨달음}
"
```

### 1.5. 목표 정렬 검증 결과 반영 (NEW)

`validate-goal-alignment` 결과를 바탕으로 목표 진척 상황 공유:

```
"🎯 목표 진척 상황:

{각 목표별 진척도}
- 목표 1: {description} → {previous}% → {current}% ({delta})
- 목표 2: {description} → {previous}% → {current}% ({delta})

{정렬된 개선점}
✅ 목표에 기여하는 개선:
- '{improvement}' → 목표 '{goal}'에 +{delta}% 기여

{정렬되지 않은 개선점이 있으면}
⚠️ 목표와 무관한 개선:
- '{improvement}' → {recommendation} 권장
"
```

**발산 경고 처리**:

발산이 감지되면 (3회 연속 진척 없음):

```
"🚨 목표 진척 점검이 필요해요

최근 {n}번의 이터레이션 동안 목표 진척이 없었어요.
지금 하고 있는 개선들이 원래 목표에서 벗어나고 있을 수 있어요.

잠깐 멈추고 확인해볼까요?
"
```

그리고 아래 옵션 제시 시 발산 대응 옵션 추가 (섹션 3 참조)

### 2. 상황 판단

개선점의 긴급도, 영향도, **목표 정렬도**를 분석:

| 상황 | 권장 액션 |
|------|----------|
| 개선점 없음 또는 사소함 | 다음 Stage로 진행 |
| 개선점 있지만 긴급하지 않음 | 기록 후 진행, v2에서 반영 |
| 개선점이 현재 Stage 내에서 해결 가능 | 작은 수정 후 진행 |
| 이전 Stage 수정 필요 | `/iterate {stage}` 제안 |
| 전체적인 방향 수정 필요 | `/next-version` 제안 |
| 완전히 다른 제품 아이디어 | `/new-product` 제안 |
| **발산 감지 (3회 연속 진척 없음)** | **목표 재검토 또는 이터레이션 중단 제안** |
| **개선점 대부분이 목표와 무관** | **목표 수정 또는 개선점 보류 제안** |

### 3. 옵션 제시

**기본 옵션** (발산 경고 없을 때):

```
"몇 가지 옵션이 있어요:

1️⃣ **계속 진행**
   지금 상태로 다음 Stage({next_stage})를 시작해요.
   개선점은 나중에 v2에서 반영할게요.

2️⃣ **작은 수정 후 진행**
   {수정 내용}만 빠르게 고치고 진행해요.
   예상 시간: {시간}

3️⃣ **돌아가서 개선**
   /iterate {suggested_stage}로 {stage}부터 다시 해요.
   {이유}

어떻게 하고 싶으세요?"
```

**발산 감지 시 추가 옵션**:

```
"🚨 목표 진척이 멈춘 것 같아요. 추가 옵션을 제안할게요:

4️⃣ **목표 재검토**
   현재 목표가 여전히 맞는지 다시 살펴봐요.
   상황이 바뀌어서 목표를 조정해야 할 수도 있어요.

5️⃣ **목표 수정**
   목표를 현실에 맞게 수정해요.
   → 달성 불가능한 목표는 축소하거나
   → 이미 달성된 목표는 완료 처리하거나
   → 새로운 목표를 추가해요.

6️⃣ **이터레이션 중단**
   지금 상태로 이 버전을 완료해요.
   완벽하지 않아도 출시하고, v2에서 개선하는 게 나을 수도 있어요.

어떻게 하고 싶으세요?"
```

**목표와 무관한 개선이 많을 때**:

```
"⚠️ 제안된 개선 중 {n}개가 현재 목표와 직접 연관이 없어요.

이런 경우 선택할 수 있어요:
- 🔄 목표 확장: 새로운 목표를 추가해서 이 개선들도 포함
- ⏸️ 개선 보류: 지금은 목표에 집중하고, 이 개선은 v2로 미룸
- ➡️ 그냥 진행: 목표와 무관해도 가치 있으면 진행

어떻게 할까요?"
```

### 4. 결정 기록

사용자의 선택을 기록:
- 선택한 옵션
- 선택 이유 (있다면)
- 타임스탬프

### 5. 회고 문서 생성

모든 내용을 `outputs/feedback/stage-{n}-reflection.md`에 저장

## 산출물

1. `outputs/feedback/stage-{n}-reflection.md` 생성
2. 다음 액션 결정

## 다음 액션 연결

| 선택 | 실행 |
|------|------|
| 계속 진행 | 다음 Stage 커맨드 안내 또는 자동 진행 |
| 작은 수정 | 해당 수정 작업 진행 |
| 돌아가서 개선 | `/iterate {stage}` 실행 안내 |
| 새 버전 | `/next-version` 실행 안내 |
| 새 제품 | `/new-product` 실행 안내 |
| **목표 재검토** | 현재 목표 목록 표시 후 유효성 확인 대화 진행 |
| **목표 수정** | 목표 수정 대화 진행, state.json 업데이트 |
| **이터레이션 중단** | 현재 버전 완료 처리, `/next-version` 제안 |
| **개선 보류** | 개선점을 v2 백로그에 기록 후 진행 |

## 완료 조건

- 피드백 요약 완료
- 목표 정렬 검증 결과 반영 완료 (NEW)
- 옵션 제시 완료 (발산 시 추가 옵션 포함)
- 사용자 결정 확인
- 회고 문서 생성
- 다음 액션 연결
- state.json 목표 진척도 업데이트 (NEW)
