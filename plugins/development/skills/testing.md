# Testing

Step 3.11: 테스트 (Testing)

> **역할: Full-stack (Backend + Frontend)**
> - Backend: API 테스트, 보안 테스트, RLS 정책 확인
> - Frontend: UI 테스트, UX 테스트, 반응형 테스트

## 설명

구현된 기능과 UI의 동작을 테스트하고, 발견된 버그를 수정하는 스킬입니다. MVP 수준의 핵심 테스트에 집중합니다.

## 트리거

- Step 3.10 (UI Implementation) 완료 후 실행
- 모든 화면 구현이 완료되었을 때

## 입력

- `outputs/stage-1/user-stories.md`
- `outputs/stage-3/feature-impl.md`
- `outputs/stage-3/ui-impl.md`
- 전체 프로젝트 코드

## 테스트 범위 (MVP 수준)

1. **핵심 사용자 흐름 테스트**
   - 회원가입 -> 로그인 -> 핵심 기능 사용

2. **[Backend] 기능 테스트**
   - API CRUD 동작 확인
   - 에러 처리 확인
   - 보안/RLS 정책 확인

3. **[Frontend] UI 테스트**
   - 반응형 동작
   - 기본 접근성

---

# Backend 테스트

## [Backend] 인증 흐름 테스트
- [ ] 회원가입: 새 계정 생성
- [ ] 이메일 인증 (설정된 경우)
- [ ] 로그인: 올바른 정보로 로그인
- [ ] 로그인 실패: 잘못된 비밀번호
- [ ] 로그아웃: 세션 종료
- [ ] 보호된 페이지: 미로그인 시 리다이렉트

## [Backend] API CRUD 테스트
- [ ] 생성(Create): 새 항목 추가
- [ ] 조회(Read): 목록 및 상세 보기
- [ ] 수정(Update): 기존 항목 수정
- [ ] 삭제(Delete): 항목 삭제
- [ ] 권한 확인: 본인 데이터만 수정/삭제 가능

## [Backend] 자동화 테스트 (선택)

MVP에서는 수동 테스트로 충분하지만, 필요시:

```typescript
// __tests__/api/posts.test.ts
import { describe, it, expect } from 'vitest'

describe('Posts API', () => {
  it('should return posts list', async () => {
    const response = await fetch('/api/posts')
    const data = await response.json()

    expect(response.status).toBe(200)
    expect(Array.isArray(data.data)).toBe(true)
  })

  it('should require auth for creating post', async () => {
    const response = await fetch('/api/posts', {
      method: 'POST',
      body: JSON.stringify({ title: 'Test' }),
    })

    expect(response.status).toBe(401)
  })
})
```

## [Backend] 보안 체크리스트

- [ ] RLS 정책 동작 확인
- [ ] 환경변수 .env에만 저장
- [ ] API 키 클라이언트에 노출 안됨
- [ ] 인증 필요한 API 보호됨
- [ ] SQL 인젝션 없음 (Supabase 사용 시 기본 방지)
- [ ] XSS 방지 (React 기본 이스케이프)

---

# Frontend 테스트

## [Frontend] UI/UX 테스트
- [ ] 로딩 상태 표시
- [ ] 에러 메시지 표시
- [ ] 성공 피드백 (토스트 등)
- [ ] 빈 상태 표시
- [ ] 반응형: 모바일, 태블릿, 데스크톱

## [Frontend] 접근성 기본 테스트
- [ ] 키보드 네비게이션 가능
- [ ] 폼 레이블 연결됨
- [ ] 이미지 alt 텍스트

---

## 버그 수정 프로세스

1. **버그 발견**: 테스트 중 문제 발견
2. **원인 분석**: 콘솔, 네트워크 탭 확인
3. **수정**: 코드 수정
4. **재테스트**: 수정 후 다시 테스트
5. **기록**: 주요 버그와 해결 방법 기록

### 일반적인 버그 패턴

| 증상 | 가능한 원인 | 해결 방법 |
|------|------------|----------|
| 페이지 404 | 라우트 파일 위치/이름 | 파일 경로 확인 |
| 데이터 안 보임 | API 에러, RLS 정책 | 콘솔/네트워크 확인 |
| 폼 제출 안됨 | action 연결 안됨 | form action 확인 |
| 스타일 안 먹음 | Tailwind 클래스 오타 | 클래스명 확인 |
| 타입 에러 | 타입 정의 불일치 | 타입 확인/수정 |

## 질문 가이드

1. **테스트 범위**
   - "핵심 기능 위주로 테스트할까요?"
   - "어떤 흐름을 먼저 테스트해볼까요?"

2. **버그 대응**
   - "이 에러가 발생했네요. 같이 확인해볼까요?"
   - "콘솔에 어떤 메시지가 나오나요?"

## 대화 원칙

- Backend 테스트 먼저 진행 후 Frontend 테스트
- 테스트 항목을 하나씩 체크
- 버그 발견 시 함께 해결
- 보안 체크리스트 확인
- MVP 수준 충분함 강조

## 산출물

`outputs/stage-3/test-report.md`

```markdown
# Test Report

## 메타데이터
- Stage: 3
- Step: 3.11 - 테스트
- 생성일시: {현재 시간}
- 상태: final

## 테스트 환경

| 항목 | 값 |
|------|-----|
| 브라우저 | Chrome 120 |
| 디바이스 | MacBook Pro |
| Node 버전 | 18.x |

## 테스트 결과 요약

| 카테고리 | 역할 | 통과 | 실패 | 총계 |
|----------|------|------|------|------|
| 인증 | Backend | 6 | 0 | 6 |
| API CRUD | Backend | 8 | 0 | 8 |
| 보안 | Backend | 6 | 0 | 6 |
| UI/UX | Frontend | 5 | 0 | 5 |
| **합계** | - | **25** | **0** | **25** |

## 상세 결과

### [Backend] 인증 흐름
| 테스트 | 결과 | 비고 |
|--------|------|------|
| 회원가입 | [x] 통과 | |
| 로그인 | [x] 통과 | |
| 로그인 실패 | [x] 통과 | 에러 메시지 표시 |
| 로그아웃 | [x] 통과 | |
| 세션 유지 | [x] 통과 | 새로고침 후 유지 |
| 보호된 라우트 | [x] 통과 | 리다이렉트 동작 |

### [Backend] API CRUD
| 테스트 | 결과 | 비고 |
|--------|------|------|
| 게시글 목록 | [x] 통과 | |
| 게시글 작성 | [x] 통과 | |
| 게시글 수정 | [x] 통과 | 본인만 가능 |
| 게시글 삭제 | [x] 통과 | 본인만 가능 |
| ... | ... | ... |

### [Backend] 보안
| 테스트 | 결과 | 비고 |
|--------|------|------|
| RLS 정책 | [x] 통과 | |
| 환경변수 보호 | [x] 통과 | |
| API 인증 | [x] 통과 | |
| ... | ... | ... |

### [Frontend] UI/UX
| 테스트 | 결과 | 비고 |
|--------|------|------|
| 로딩 상태 | [x] 통과 | |
| 에러 표시 | [x] 통과 | |
| 빈 상태 | [x] 통과 | |
| 모바일 반응형 | [x] 통과 | |
| 데스크톱 반응형 | [x] 통과 | |

## 수정된 버그

| 버그 | 원인 | 해결 |
|------|------|------|
| {버그 설명} | {원인} | {해결 방법} |
| ... | ... | ... |

## 알려진 이슈 (MVP 이후)

| 이슈 | 우선순위 | 비고 |
|------|----------|------|
| {이슈} | P2 | MVP 이후 수정 예정 |
| ... | ... | ... |

## 다음 단계

빌드 및 배포 준비를 진행합니다.
```

## 완료 조건

- 핵심 사용자 흐름 테스트 통과
- 주요 버그 수정 완료
- 보안 체크리스트 확인 완료
- `test-report.md` 파일이 생성됨

## 다음 Step

→ Step 3.12: Build Ready (빌드 준비)
